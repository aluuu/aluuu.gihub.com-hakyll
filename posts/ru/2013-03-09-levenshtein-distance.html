<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>Alexander Dinu</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <link rel="alternate" type="application/atom+xml" href="../../atom.xml" title="Бложик">
    <link href="http://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="../../css/typeplate.css">
    <link rel="stylesheet" href="../../css/style.css">
  </head>
  <body>
    <header>
      <nav>
        <ul>
          <li><a href="../../">Последнее</a></li>
          <li><a href="https://twitter.com/aluuu">Твиттер</a></li>
          <li><a href="https://github.com/aluuu">Гитхаб</a></li>
        </ul>
      </nav>
    </header>
    <section>
      <article>
  <h3>Расстояние Левенштейна <small>09.03.2013 <a href="../../posts/ru/2013-03-09-levenshtein-distance.html">#</a></small></h3>
  <p>Поскольку скоро придётся сравнивать много всяких последовательностей, запилил я <a href="http://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D0%B5_%D0%9B%D0%B5%D0%B2%D0%B5%D0%BD%D1%88%D1%82%D0%B5%D0%B9%D0%BD%D0%B0">расстояние Левенштейна</a> на Clojure (эксперимента ради).</p>
<p>Возьмём реализацию в лоб:</p>
<pre><code class="clojure">(defn levenshtein-distance
  [seq1 seq2]
  (cond
   (empty? seq1) (count seq2)
   (empty? seq2) (count seq1)
   :else (min
          (+ (if (= (first seq1) (first seq2)) 0 1)
             (#'levenshtein-distance (rest seq1) (rest seq2)))
          (inc (#'levenshtein-distance (rest seq1) seq2))
          (inc (#'levenshtein-distance seq1 (rest seq2))))))
</code></pre>
<p>Всё очень плохо:</p>
<pre><code class="clojure">(time (levenshtein-distance (shuffle (range 10))
                            (shuffle (range 10))))
"Elapsed time: 2566.345769 msecs"
9
</code></pre>
<p>Делаем хорошо следующим образом. В <code>clojure.core</code> есть отличная функция <a href="http://clojuredocs.org/clojure_core/clojure.core/memoize"><code>memoize</code></a>, которая возвращает <a href="http://en.wikipedia.org/wiki/Memoization">мемоизированную</a> версию заданной функции.</p>
<p>Замутим мемоизацию для функции levenstein-distance:</p>
<pre><code class="clojure">(defn memo-levenshtein-distance
  [seq1 seq2]
  (cond
   (empty? seq1) (count seq2)
   (empty? seq2) (count seq1)
   :else (min
          (+ (if (= (first seq1) (first seq2)) 0 1)
             (#'memo-levenshtein-distance (rest seq1)
                                          (rest seq2)))
          (inc (#'memo-levenshtein-distance (rest seq1)
                                            seq2))
          (inc (#'memo-levenshtein-distance seq1
                                            (rest seq2))))))

(def memo-levenshtein-distance (memoize memo-levenshtein-distance))
</code></pre>
<p>Проверим насколько стало хорошо:</p>
<pre><code class="clojure">(let [seq1 (shuffle (range 10))
      seq2 (shuffle (range 10))]
  (map #(time (% seq1 seq2))
       [levenshtein-distance
        memo-levenshtein-distance]))
 ("Elapsed time: 2560.824951 msecs"
 "Elapsed time: 1.265487 msecs"
 9
 9)
</code></pre>
<p>Радуемся.</p>
</article>

    </section>
  </body>
</html>
